from typing import List
from myUtils.Utils import printResult
from collections import defaultdict
import math
from collections import deque

class Solution:
    def parse(self, input: List[str]):
        matrix = []
        starting = []
        for r in range(self.rows):
            line = input[r]
            row = []
            for c in range(self.cols):
                if line[c] == "S":
                    starting.append((r,c))
                row.append(line[c])
            matrix.append(row)
        # print(matrix)
        return matrix, starting

    def navigate(self, matrix: List[List[str]], row:int, col: int) -> int:
        q = deque()
        q.append((row,col))
        count = 0
        known = set()
        visited = set()
        while q:
            r, c = q.popleft()

            if (r,c) in visited:
                continue
        
            visited.add((r,c))

            if matrix[r][c] == "S" or matrix[r][c] == "|":
                if 0 <= r + 1 < self.rows:
                    q.append((r + 1, c))
                    if matrix[r+1][c] == ".":
                        matrix[r+1][c] = "|"
            elif matrix[r][c] == "^":
                if (r,c) not in known:
                    count += 1
                known.add((r,c))
                if 0 <= c-1 < self.cols:
                    q.append((r, c-1))
                    if matrix[r][c-1] == ".":
                        matrix[r][c-1] = "|"
    
                if 0 <= c+1 < self.cols:
                    q.append((r, c+1))
                    if matrix[r][c+1] == ".":
                        matrix[r][c+1] = "|"
        return count

    def getBeamSplits(self, input: List[str]) -> int:
        self.rows = len(input)
        self.cols = len(input[0])
        matrix, starting = self.parse(input)
        row, col = starting[0]
        result = self.navigate(matrix, row, col)

        return result


obj = Solution()

input = [
".......S.......",
"...............",
".......^.......",
"...............",
"......^.^......",
"...............",
".....^.^.^.....",
"...............",
"....^.^...^....",
"...............",
"...^.^...^.^...",
"...............",
"..^...^.....^..",
"...............",
".^.^.^.^.^...^.",
"...............",
]
expected = 21
result = obj.getBeamSplits(input)
printResult(result, expected)

input = [
"......................................................................S......................................................................",
".............................................................................................................................................",
"......................................................................^......................................................................",
".............................................................................................................................................",
".....................................................................^.^.....................................................................",
".............................................................................................................................................",
"....................................................................^.^.^....................................................................",
".............................................................................................................................................",
"...................................................................^.^.^.^...................................................................",
".............................................................................................................................................",
"..................................................................^.....^.^..................................................................",
".............................................................................................................................................",
".................................................................^.^.^.....^.................................................................",
".............................................................................................................................................",
"................................................................^...^.^.^.^.^................................................................",
".............................................................................................................................................",
"...............................................................^.^.^.^.^...^.^...............................................................",
".............................................................................................................................................",
"..............................................................^.^.^.^.^.....^.^..............................................................",
".............................................................................................................................................",
".............................................................^...^.^.^...^.....^.............................................................",
".............................................................................................................................................",
"............................................................^...^.^.....^.^...^.^............................................................",
".............................................................................................................................................",
"...........................................................^...^.^.......^.^.....^...........................................................",
".............................................................................................................................................",
"..........................................................^.^.^...^.^...^...^.....^..........................................................",
".............................................................................................................................................",
".........................................................^.^.^.^...^.......^...^.^.^.........................................................",
".............................................................................................................................................",
"........................................................^.^.^.^.^...^.^.^.^.^.^...^.^........................................................",
".............................................................................................................................................",
".......................................................^.^.^.^...^.^.^.^.^.^.^.......^.......................................................",
".............................................................................................................................................",
"......................................................^.....^.^...^.^.^.^...^...^.^.^.^......................................................",
".............................................................................................................................................",
".....................................................^.^.^...^.^.^.^.^.....^...^.^.^.^.^.....................................................",
".............................................................................................................................................",
"....................................................^.....^.^.^.^.^.^...^.^.^.....^.....^....................................................",
".............................................................................................................................................",
"...................................................^.....^.^...^.^.^.^.^.^.^.^.^.^.^.^.^.^...................................................",
".............................................................................................................................................",
"..................................................^.^.....^...^...^.^...^.^.^.^.^.^.^.....^..................................................",
".............................................................................................................................................",
".................................................^.^.^.^...^.......^.^.^.^.^...^.^.^.^.^...^.................................................",
".............................................................................................................................................",
"................................................^.^...^.^...^...^.^...^.^.^.^.^.^.^.^.^...^.^................................................",
".............................................................................................................................................",
"...............................................^...^...^...^.....^.^.^.^.^.^.....^...^.^.^.^.^...............................................",
".............................................................................................................................................",
"..............................................^...^.^.....^.^.^.....^.^.^...^.^...^.^.^...^.^.^..............................................",
".............................................................................................................................................",
".............................................^.^.^.^...^...^.^.^...^.^.^...^.^.....^...^.^...^.^.............................................",
".............................................................................................................................................",
"............................................^.^.^.^.^.^.^.^.^.....^.^.....^.^.^...^...^.^.^...^.^............................................",
".............................................................................................................................................",
"...........................................^.^.^.^.^.^.^...^.^.^.^...^.......^.^...........^.^.^.^...........................................",
".............................................................................................................................................",
"..........................................^.^...^.^.^.^.^.^.^.^.^...^.^.^.^.....^.^.^.^.^.........^..........................................",
".............................................................................................................................................",
".........................................^.^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.........................................",
".............................................................................................................................................",
"........................................^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.^...^.^...^.^.^.^.^.^.^...^.^........................................",
".............................................................................................................................................",
".......................................^.^.......^...^...^.^.^.^...^...^.^.^...^...^...^...^...^.^.^.^.......................................",
".............................................................................................................................................",
"......................................^.......^...^.^.^.^.^...^...^.^.^.^...^.^.^.^...^.^.^...^.^.^...^......................................",
".............................................................................................................................................",
".....................................^.^.^.^.^.^.^.^.^...^.^...^...^.^.^.^.^...^.^.....^.^.^.^.^.^.^.^.^.....................................",
".............................................................................................................................................",
"....................................^.^.^...^.^...^.^...^.....^...^.^...^.^.^.......^.^...^.....^.^.^.^.^....................................",
".............................................................................................................................................",
"...................................^.^.^.^...^.^.^...^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.^.....^.^.^.^.^.^...................................",
".............................................................................................................................................",
"..................................^.^.^.^.^.^.^...........^.^.^.^.^...^...^...^.^.^.^.^.^.^...^.^.^...^...^..................................",
".............................................................................................................................................",
".................................^.^.^.^.^.^.^.^.^.....^.^...^.^.....^.^...^.^.^.^.^.....^.^.....^.^.^.....^.................................",
".............................................................................................................................................",
"................................^...^.^.^.^.......^.^.^...^...^.^.^.^...^...^.^.....^.....^.^.^...^.^.....^.^................................",
".............................................................................................................................................",
"...............................^...^.^...^.......^...^.^.^.^.^.^...^...^.^.^...^...^.^.^.^.^.^.^.^.....^.^.^.^...............................",
".............................................................................................................................................",
"..............................^.^.^...^.^...^.^.^.^.^.^.^...^.^.^.^.^...^...^.....^...^.^.........^.....^...^.^..............................",
".............................................................................................................................................",
".............................^...^.^...^.....^.^.^.^.......^.^...^.^.^.^.^...^.^...^.^.^.^.^...^.^.^.^.^.^.....^.............................",
".............................................................................................................................................",
"............................^.^.^.......^.....^...^.^.^.^.^.......^.^.^.^.....^.^.^.^...^...^.^.^...^...^.^.^.^.^............................",
".............................................................................................................................................",
"...........................^.......^...^.^.^.^...^...^.^.^...^.^.^...^.^.....^.^.^.^.^.....^.^.^.^.^.^.^.^.^.^.^.^...........................",
".............................................................................................................................................",
"..........................^.^.^.^.^.^.^.....^.^...^.^...^.^.^.^.^...^...^.^...^.^.^.^.^.....^.^.^...^.^...^...^.^.^..........................",
".............................................................................................................................................",
".........................^.^.^.^.^.^.^.^.......^...^.^.^...^.^.^.^...^.^.....^...^.^.^.^.^.^...^.^...^.^.^.^.^.^...^.........................",
".............................................................................................................................................",
"........................^.^...^.......^.^.....^.....^.^.^.^.^...^.^.^.^.......^.^.^.^.^...^.^.^.^.^.....^.^.^.^...^.^........................",
".............................................................................................................................................",
".......................^.^.^.^...^...^.......^.....^...^.^.^.^.....^...^...^...^.^.^.........^.^.^...^.^.^.^.^.^.....^.......................",
".............................................................................................................................................",
"......................^.^...^.^.^.^.^.^.^...^...^.^...^...^.^.^...^...^.^.^...^.....^...^.^.^.^.^...^.^...^.^...^.^.^.^......................",
".............................................................................................................................................",
".....................^.^.^...^.^.^.^.^.^.^.^...^...^.....^...^.^.^.....^.^.^...^...^.^.^.^...^.....^.^...^.^.^.^...^.^.^.....................",
".............................................................................................................................................",
"....................^.^.....^.^.^.^.^.^.^...^.^.^.^...^...^.^...^...^.^.^.^.^.^...^...^.^...^.....^.^.^...^.^.^.........^....................",
".............................................................................................................................................",
"...................^.^.^.^.^...^.^...^.^.......^.^...^...^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.......^...^.^.^...^.^.......^.^.^...................",
".............................................................................................................................................",
"..................^.^.^...^.^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.....^.^.^.^...^.^.....^.^.^.^...^.^.^.^.^.^.^.^...^.^.....^..................",
".............................................................................................................................................",
".................^.^.^.^.^.^.^.^.^...^...^.^.....^.^...^.......^.^.^.^.^.^.^...^.....^.....^.^.^.^...^.^.^.^.^.^.^.....^.^.^.................",
".............................................................................................................................................",
"................^.^.^.^.^.^.^.^.....^.^.^...^.^.^.^.^.^.^.^.^.^.....^.......^.^.^.....^...^...^.^.....^.^.^...^.^.^.^.^.....^................",
".............................................................................................................................................",
"...............^.^.^.^...^.^.^.^...^.^...^.^.........^.^.^...^.^...^.....^.^.....^.^.^.^...^.^.^.^.......^.^.^.^.^.^.^.^.^...^...............",
".............................................................................................................................................",
"..............^.^.^.......^.^.^.^.^.^...^.^.^.^.......^.^.......^.......^.^.^...^.^.....^.^.^.^.^.^...^...^.....^.^.^...^.^.^.^..............",
".............................................................................................................................................",
".............^...^.^...^.^.^.^...^.^.^...^.^.....^.^.^...^.^.....^.^.^.^.^...^...^.^.^.^.^...^...^.^.^.^...^.^.....^.^.^...^.^.^.............",
".............................................................................................................................................",
"............^.^.......^.^.^.^.^.^.^.^...^.^.....^.^.^.^.^.^.^.....^...^.^.^.^.....^.^.^.^.^...^...^.^.^.^.^...^.^.....^.^.^...^.^............",
".............................................................................................................................................",
"...........^.^...^.^.^.^.........^.^.^.^...^.^.^.^.....^.^...^.^...^.^.......^...^.....^.^.^.^.^.^.^.^.^.^.^.^.^...^.....^.^.^.^.^...........",
".............................................................................................................................................",
"..........^.....^.^.^.^...^.......^...^.^.^.^.^.^.^...^.^.^.^.^.^.^.^.^...^.^.^...^.^...^.........^.^.......^.^.....^.^...^.......^..........",
".............................................................................................................................................",
".........^.....^.^...^.....^.^...^...^.^.^.^.^.^.^.^...^.....^.^.^.....^.^.....^.^.^...^.^.^.^.^.........^.^.....^.^.^.^...^.^.^...^.........",
".............................................................................................................................................",
"........^.^...^.....^...^.^.^...^.^...^.^.^.^...^...^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.^...^...^...^.^.....^.^.^.^.........^...^.^.^...^........",
".............................................................................................................................................",
".......^...^.^...^.^.^.^.^.^.^.^...^.^.....^.^.^.^.^.^.^...^.^.^.............^...^.^.^.^.^.^.^.^...^...^.^.^.^.........^...........^.^.......",
".............................................................................................................................................",
"......^.^.^...^...^...^.....^.^.^...^.....^.^...^.^.^.^.^.^.....^.^.^.^...^.^...^.^.^.^...^.....^.^.^.^.^.^.^.^.........^...^...^.^.^.^......",
".............................................................................................................................................",
".....^.^.^.^.....^.^.....^.^...^.^...^...^.^.^.^...^.^.^.^.^.......^.^...^.^...^...^.^.^.^...^.^...^...^...^...^.^.........^.^.^.^.^.^.^.....",
".............................................................................................................................................",
"....^.^.^...^.^...^.^.....^.^.^.^...^.^.^.....^.^...^.^.^.^.^.^.^...^.....^.....^.^.^...^.^.^.^.^.....^.^.^.^.^...^.^.^.^.^.^.^.^...^.^.^....",
".............................................................................................................................................",
"...^.^.^.^...^.^.^.^.^.^.^.....^.^.......^.^.^...^.^.^...^.....^.^.......^.^.^.^.^.....^...^.^.^...^...^.........^.^.^.^.^...^.^.^.......^...",
".............................................................................................................................................",
"..^.^...^...^.^.^.^.^...^...^.^.^.^.^...^...^.^...^.^.^.^.^...^.^.^.^...^.^...^.^.^...^.^.^.^...^...^.^.^.^.^.....^...^.^.^.^.^.^.^.^.^.^.^..",
".............................................................................................................................................",
".^.^.^.....^.^...^.^.^.....^.^.^...^.....^.^.^.^.^.^.^.^.^...^.^.^.^.^.....^.^.^.....^.^.......^...^.^.^.^.^.^...^.^.^.^.^...^.^.^.^.^.^.^.^.",
".............................................................................................................................................",
]
expected = 1626
result = obj.getBeamSplits(input)
printResult(result, expected)
